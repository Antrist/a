
ExtractEvidence (StratifyBAM)
- export per chr: all reads potentially supporting SV:
-- SC, OEA, DP (should we split these further like Socrates does now?)
- mate-coordinate sorted OEA & DP
Input: sorted BAM
Output: sorted BAM of SV evidence; mate-coordinate sorted BAM

GenerateDirectedBreakpoints (StratifyBAM)
- Extract consensus breakpoint sequences
-- assembly conensus (where possible)
-- direct longSC extraction (as per Socrates)
Input: previous step
Output: FASTQ of breakpoint sequences to realign, VCF of anchors

RealignBreakpoints
- probably just py script with bowtie2 as per existing Socrates
- followed by samtools sort/SortSAM of output
-- we could probably get away without sorting at all
--- no sorting (with bowtie2 --reorder) means we scan according to anchor position

ReciprocalBreakpointClustering (RealignmentClustering)
- cluster directed breakpoint
-- reciprocal consensus sequence support
-- should handle both realignment per read (ie socrates), consensus realignment (idsv) & inexact discordant pair clustering in a single unified clustering algorithm
-- should not use O(n^4) implementation currently used by socrates
-- O(nlogn) possible using something like an IntervalNabvigableMap as an adjacency graph
--- may require multiple passes of input file if all breakpoints not able to be stored in memory for WGS data sets)
--- can keep working sets small by processing each chr-chr pair separately (as per socrates)
---- need separate passes for repeat breakpoints and each chr-chr pairing including intra-chr passes
--- try generating full graph and see if it fits in memory
- call repeat breakpoints based on repeat annotation & mapq of realignment
Input: anchor VCF & realigned breakpoints
Output: VCF breakpoints including phred-like score

DetectGeneRetrocopies
- as per idsv implementation
Input: anchor VCF, UCSC known genes (exon list)
Output: transcript retrocopy variant calls

GenotypeBreakpoints
Input: breakpoint VCF
Output: SV genotypes
- could be used with other SV breakpoint calls (eg HYDRA)
- being done by masters student?


































